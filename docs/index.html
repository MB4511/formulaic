<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dynamic Generation and Quality Checks of Formula Objects • formulaic</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Dynamic Generation and Quality Checks of Formula Objects">
<meta property="og:description" content="Many statistical models and analyses in R are implemented through formula objects. The formulaic package creates a unified approach for programmatically and dynamically generating formula objects. Users may specify the outcome and inputs of a model directly, search for variables to include based upon naming patterns, incorporate interactions, and identify variables to exclude. A wide range of quality checks are implemented to identify issues such as misspecified variables, duplication, a lack of contrast in the inputs, and a large number of levels in categorical data.  Variables that do not meet these quality checks can be automatically excluded from the model.  These issues are documented and reported in a manner that provides greater accountability and useful information to guide an investigation of the data.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">formulaic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Introduction-to-formulaic.html">Introduction to Formulaic</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="formulaic" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#formulaic" class="anchor"></a>formulaic</h1></div>

<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p><strong>Formulaic</strong> is useful to create a dynamic formula with multiple features. It not only diminishes the time required for modeling and implementing, but also enriches the quality of the result.</p>
<p>Many statistical models and analyses in R are implemented through formula objects. The formulaic package creates a unified approach for programmatically and dynamically generating formula objects in R. Users may specify the inputs and outcomes of a model directly, search for variables to include based upon naming patterns, and identify variables to exclude. A wide range of quality checks are implemented to identify issues such as misspecified variables, duplication, a lack of contrast in the inputs, and a large number of levels in categorical data. These issues are documented and reported in a manner that provides greater accountability and useful information to guide an investigators choices in selecting features.</p>
<p>Dynamically generated formula objects can enable the development of applications that incorporate a user’s inputs for selecting the variables of a model and the subsets of data to include. The quality checks enable a programmatic reduction of the inputs to those that are appropriate for inclusion in the model. By automatically limiting these selections, many models that would lead to errors or intractable computations may be proactively avoided. By performing this process in the creation of the formula, all statistical models and analyses relying on formula objects can easily make use of these features. Furthermore, the list of quality checks can be easily expanded to incorporate additional concerns.</p>
</div>
<div id="install-the-current-release-from-cran" class="section level2">
<h2 class="hasAnchor">
<a href="#install-the-current-release-from-cran" class="anchor"></a>Install the current release from CRAN:</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'formulaic'</span>)</a></code></pre></div>
</div>
<div id="install-the-development-version-from-github" class="section level2">
<h2 class="hasAnchor">
<a href="#install-the-development-version-from-github" class="anchor"></a>Install the development version from GitHub:</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">'dachosen1/formulaic'</span>)</a></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>Formulaic package has two main functions – <strong>create.formula</strong> and <strong>reduce.existing.formula</strong> – and one subsidiary function, <strong>add.backticks</strong>. The main purpose of developing the package is to help users to build a robust model faster and more convenient.</p>
<p><strong>create.formula</strong> automatically creates a formula from a provided list of input variables and the output variable. The variables will undergo a series of qualification tests such as automatic variable/categories reduction, typo, duplication, and lack of contrasted features elimination, etc. to make sure that a given feature is usable for modeling. This will reduce the time to build a model and set the users free from the trivial maneuver: manually inputting variables for modeling. The outcome of this formula can be used in a wide range from simple linear regression to any machine learning techniques such as random forest, neural network, etc.</p>
<p>The principal advantages of using create.formula are followed:</p>
<p>1) Being able to dynamically generate a formula from a vector of inputs, without necessarily having to spell them all out by name.</p>
<p>2) Adding variables by searching for patterns.</p>
<p>3) Simple integration of interactions.</p>
<p>4) Easy removal of specific variables.</p>
<p>5) Quality checks that resolve a variety of issues – typos, duplication, lack of contrast, etc. – while providing a transparent explanation.</p>
<p><strong>reduce.existing.formula</strong> trims an existing formula down. Users plug an existing formula into the function, then it will undergo the same test as create.formula.</p>
<p><strong>add.backticks</strong> applies backticks the variables needs backticks to be employed in a formula as default. Users can also add backticks to all the variables; however, it is not necessary.</p>
<div id="example" class="section level3">
<h3 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">n &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb3-2" title="2">dd &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">data.table</span>(<span class="dt">w =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n=</span> n), <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n =</span> n), <span class="dt">pixel_1 =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n =</span> n))</a>
<a class="sourceLine" id="cb3-3" title="3">dd[, <span class="st">'pixel 2'</span> <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="fl">0.3</span> <span class="op">*</span><span class="st"> </span>pixel_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n)]</a>
<a class="sourceLine" id="cb3-4" title="4">dd[, pixel_<span class="dv">3</span> <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="fl">0.3</span> <span class="op">*</span><span class="st"> </span>pixel_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n)]</a>
<a class="sourceLine" id="cb3-5" title="5">dd[, item_<span class="dv">1</span> <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="fl">0.3</span> <span class="op">*</span><span class="st"> </span>pixel_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n)]</a>
<a class="sourceLine" id="cb3-6" title="6">dd[, item_<span class="dv">2</span> <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="fl">0.3</span> <span class="op">*</span><span class="st"> </span>pixel_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n)]</a>
<a class="sourceLine" id="cb3-7" title="7">dd[, y <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span>pixel_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pixel_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n)]</a></code></pre></div>
<p>The resulting script create a data.table with 8 unique features</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(dd)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">"w"</span>       <span class="st">"x"</span>       <span class="st">"pixel_1"</span> <span class="st">"pixel 2"</span> <span class="st">"pixel_3"</span> <span class="st">"item_1"</span>  <span class="st">"item_2"</span>  <span class="st">"y"</span>  </a></code></pre></div>
<p>Traditionally, creating a formula in R required the user to manually select the desired variables or use the y~. notation to select all the features. <strong><code>formulaic</code></strong> is useful to programmatically select variables to include and performs quality check against the input.</p>
<p><strong>use case:</strong> Creating a model with all pixel patterns</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># create formula object </span></a>
<a class="sourceLine" id="cb5-2" title="2">formula1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/create.formula.html">create.formula</a></span>(<span class="dt">outcome.name =</span> <span class="st">"y"</span>, <span class="dt">input.names =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>,<span class="st">"Random error"</span>, <span class="st">"y"</span>), <span class="dt">input.patterns =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"pix"</span>), <span class="dt">dat =</span> dd)</a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4">formula1<span class="op">$</span>formula</a>
<a class="sourceLine" id="cb5-5" title="5">y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>pixel_<span class="dv">1</span> <span class="op">+</span><span class="st"> `</span><span class="dt">pixel 2</span><span class="st">`</span> <span class="op">+</span><span class="st"> </span>pixel_<span class="dv">3</span></a></code></pre></div>
<p>The result is a formula object of all the pixel variables and the input x. Notice that ‘Random error’ variable was automatically excluded from the output and a backtick was automatically added to the variable pixel 2. Since the the independent variable y was included as feature, it was excluded from the output formula.</p>
<p>Details of the variables included is provided in the inclusion table</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># inclustion table</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="op">&gt;</span><span class="st"> </span>formula1<span class="op">$</span>inclusion.table</a>
<a class="sourceLine" id="cb6-3" title="3">       variable   class order specified.from exclude.user.specified exclude.not.in.names.dat exclude.matches.outcome.name include.variable</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="dv">1</span><span class="op">:</span><span class="st">            </span>x numeric     <span class="dv">1</span>    input.names                  <span class="ot">FALSE</span>                    <span class="ot">FALSE</span>                        <span class="ot">FALSE</span>             <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="dv">2</span><span class="op">:</span><span class="st"> </span>Random error    <span class="op">&lt;</span><span class="ot">NA</span><span class="op">&gt;</span><span class="st">     </span><span class="dv">2</span>    input.names                  <span class="ot">FALSE</span>                     <span class="ot">TRUE</span>                        <span class="ot">FALSE</span>            <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="dv">3</span><span class="op">:</span><span class="st">            </span>y numeric     <span class="dv">3</span>    input.names                  <span class="ot">FALSE</span>                    <span class="ot">FALSE</span>                         <span class="ot">TRUE</span>            <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="dv">4</span><span class="op">:</span><span class="st">      </span>pixel_<span class="dv">1</span> numeric     <span class="dv">4</span> input.patterns                  <span class="ot">FALSE</span>                    <span class="ot">FALSE</span>                        <span class="ot">FALSE</span>             <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="dv">5</span><span class="op">:</span><span class="st">      </span>pixel <span class="dv">2</span> numeric     <span class="dv">5</span> input.patterns                  <span class="ot">FALSE</span>                    <span class="ot">FALSE</span>                        <span class="ot">FALSE</span>             <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="dv">6</span><span class="op">:</span><span class="st">      </span>pixel_<span class="dv">3</span> numeric     <span class="dv">6</span> input.patterns                  <span class="ot">FALSE</span>                    <span class="ot">FALSE</span>                        <span class="ot">FALSE</span>             <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb6-10" title="10"></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co"># implement formula object</span></a>
<a class="sourceLine" id="cb6-12" title="12">model &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="dt">formula =</span> formula1, <span class="dt">data =</span> dd)</a></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=formulaic">https://​cloud.r-project.org/​package=formulaic</a>
</li>
<li>Report a bug at <br><a href="https://github.com/dachosen1/formulaic/issues">https://​github.com/​dachosen1/​formulaic/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> </li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>David Shilane <br><small class="roles"> Author </small>  </li>
<li>Anderson Nelson <br><small class="roles"> Contributor, maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.com/dachosen1/formulaic"><img src="https://travis-ci.com/dachosen1/formulaic.svg?token=Vccc85T4kcPx9zLDqfTx&amp;branch=master" alt="Build Status"></a></li>
<li><a href="https://codecov.io/gh/dachosen1/formulaic"><img src="https://codecov.io/gh/dachosen1/formulaic/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0.en.html"><img src="https://img.shields.io/badge/license-GPL--3-blue.svg" alt="license"></a></li>
<li><a href="https://CRAN.R-project.org/package=formulaic"><img src="https://www.r-pkg.org/badges/version/formulaic" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/package=formulaic"><img src="http://cranlogs.r-pkg.org/badges/grand-total/formulaic?color=blue"></a></li>
<li><a href="https://cran.r-project.org/package=formulaic"><img src="https://cranlogs.r-pkg.org/badges/formulaic"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by David Shilane, Anderson Nelson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
